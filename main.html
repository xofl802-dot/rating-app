<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>감정평가부 직원 평가</title>

<style>

body{
font-family:맑은고딕;
padding:20px;
}

table{
border-collapse:collapse;
width:100%;
}

th, td{
border:1px solid #ccc;
padding:8px;
text-align:center;
}

th{
background:#f2f2f2;
}

select, input{
padding:5px;
}

textarea{
width:200px;
height:50px;
}

button{
padding:10px;
margin-top:10px;
font-size:16px;
}

</style>

</head>
<body>

<h2>감정평가부 직원 평가</h2>

평가자:

<select id="evaluator">

<option value="">선택</option>

<option>김경호</option>
<option>김진영</option>
<option>신의정</option>
<option>최재은</option>
<option>박현수</option>
<option>윤정균</option>
<option>박소미</option>
<option>박태용</option>
<option>박창범</option>
<option>한우진</option>

</select>

<br><br>

평가서번호:

<input type="text" id="reportNo"
placeholder="2501-04-4550">

<br><br>

<table>

<tr>

<th>직원명</th>
<th>속도</th>
<th>정확성</th>
<th>협력성</th>
<th>기타</th>
<th>코멘트</th>
<th>총점</th>

</tr>

<script>

const 직원목록 = [

"김경호",
"김진영",
"신의정",
"최재은",
"박현수",
"윤정균",
"박소미",
"박태용",
"박창범",
"한우진"

];

const 점수값 = {

"S":100,
"A":90,
"B":80,
"C":70,
"D":60

};

function 점수선택(id){

return `

<select id="${id}" onchange="calc('${id}')">

<option value="">선택</option>

<option value="S">S</option>
<option value="A">A</option>
<option value="B">B</option>
<option value="C">C</option>
<option value="D">D</option>

</select>

`;

}

직원목록.forEach((name,i)=>{

document.write(`

<tr>

<td>

<select id="employee${i}">

<option value="">선택</option>

${직원목록.map(n=>`<option>${n}</option>`).join("")}

</select>

</td>

<td>${점수선택("speed"+i)}</td>

<td>${점수선택("accuracy"+i)}</td>

<td>${점수선택("team"+i)}</td>

<td>${점수선택("etc"+i)}</td>

<td>

<textarea id="comment${i}"></textarea>

</td>

<td id="total${i}">0</td>

</tr>

`);

});

function calc(){

직원목록.forEach((_,i)=>{

let total=0;

let speed=
document.getElementById("speed"+i).value;

let accuracy=
document.getElementById("accuracy"+i).value;

let team=
document.getElementById("team"+i).value;

let etc=
document.getElementById("etc"+i).value;

if(speed) total+=점수값[speed];
if(accuracy) total+=점수값[accuracy];
if(team) total+=점수값[team];
if(etc) total+=점수값[etc];

document.getElementById("total"+i).innerText=total;

});

}

function save(){

let data=[];

직원목록.forEach((_,i)=>{

data.push({

평가자:
document.getElementById("evaluator").value,

평가서번호:
document.getElementById("reportNo").value,

직원명:
document.getElementById("employee"+i).value,

속도:
document.getElementById("speed"+i).value,

정확성:
document.getElementById("accuracy"+i).value,

협력성:
document.getElementById("team"+i).value,

기타:
document.getElementById("etc"+i).value,

코멘트:
document.getElementById("comment"+i).value,

총점:
document.getElementById("total"+i).innerText

});

});

console.log(data);

alert("저장완료 (콘솔확인)");

}

</script>

</table>

<button onclick="save()">저장</button>

</body>
</html>
